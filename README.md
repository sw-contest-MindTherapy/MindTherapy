# 서비스

<aside>
✅ 전문가뿐 아니라 **일반인 "누구나"** 상담자가 될 수 있는 **AI 기반** 심리상담 서비스입니다.

</aside>

### 서비스 개발 계기(배경)

<aside>
<img src="/icons/book_gray.svg" alt="/icons/book_gray.svg" width="40px" /> **최근 전국민을 두려움에 떨게 했던 "묻지마 칼부림" 사건에 대해 어떻게 생각하시나요?**

**특히 저는 서현역 사건 당시 근처에 있었고 20년 넘게 살아왔던 고향이라 매우 충격적이었고 분노했습니다.**

**그러다 말로만 한탄하기 보다는 근본적인 원인이 궁금하였고 이는 대부분 "정신질환 혹은 현실불만자"이었습니다.**

**이러한 반복되는 정신질환자 및 현실불만자들의 범죄를 조금이나마 감소시키고 예방되기를 희망하며 이 서비스를 개발하게 되었습니다.**

</aside>

![ 최근 정신질환 관련 중대범죄 (출처 . 한국일보기사)](https://prod-files-secure.s3.us-west-2.amazonaws.com/31468e2d-8c82-4342-8c4d-2528c4d3e4b5/ff935e3c-dee9-48a3-a5e7-6c2499a98aaf/%EB%AC%BB%EC%A7%80%EB%A7%88%EB%B2%94%EC%A3%84_%EC%A0%95%EC%8B%A0%EC%A7%88%ED%99%98.png)

 최근 정신질환 관련 중대범죄 (출처 . 한국일보기사)

![칼부림 원인자료](https://prod-files-secure.s3.us-west-2.amazonaws.com/31468e2d-8c82-4342-8c4d-2528c4d3e4b5/ec3d7401-2041-4ef0-a686-645117a177f3/%EC%A0%95%EC%8B%A0%EC%A7%88%ED%99%98_%EC%9E%90%EB%A3%8C_2.png)

칼부림 원인자료

![ 자료-코로나19이후 정신질환자들의 증가](https://prod-files-secure.s3.us-west-2.amazonaws.com/31468e2d-8c82-4342-8c4d-2528c4d3e4b5/6f4c277a-f464-4b63-b3e7-838e1680ad87/%EC%BD%94%EB%A1%9C%EB%82%98_%EC%9D%B4%ED%9B%84_%EC%A0%95%EC%8B%A0%EC%A7%88%ED%99%98%EC%A6%9D%EA%B0%80%EC%9E%90%EB%A3%8C.png)

 자료-코로나19이후 정신질환자들의 증가

**이러한 사람들이 처음부터 정신질환자들이였을까?**

### 이용 대상

- `**마음의 병으로 심리상담이 필요하지만 병원 진료나 전문 상담사와의 상담은 부담스러운 사람.**`
- `**평소 내향적인 성격으로  감정표현이 어렵거나 소통이 필요한 사람.**`
- `**전문 상담사가 되기 위한 기반이나 경험이 필요한 사람**`
- `**한때 자신도 환자로 경험했던 경험들을 상담자가되어 공유하는 선순환을 기대하는 모든 것.**`

---

![홈페이지 메인 배너](https://prod-files-secure.s3.us-west-2.amazonaws.com/31468e2d-8c82-4342-8c4d-2528c4d3e4b5/928a3781-dd87-47fe-a53c-62f7b11dc63d/service.png)

홈페이지 메인 배너

![service.jpg](https://prod-files-secure.s3.us-west-2.amazonaws.com/31468e2d-8c82-4342-8c4d-2528c4d3e4b5/1e24a219-eb2f-4809-8ebc-8378b2200bb3/service.jpg)

<aside>
🛠 저희의 서비스는 심리 상담에 더욱 부담 없이 쉽게 접근하도록 합니다.

</aside>

# 🤨상담자 또는 상담사로 회원가입

---

![역할선택.PNG](https://prod-files-secure.s3.us-west-2.amazonaws.com/31468e2d-8c82-4342-8c4d-2528c4d3e4b5/a44b0eee-44fd-497f-aaf6-947563ff0fbd/%EC%97%AD%ED%95%A0%EC%84%A0%ED%83%9D.png)

<aside>
📚 **누구나 상담사가 되어 도움을 줄 수도 있고, 또 다른 누군가는 상담자가 되어 도움을 받을 수도 있습니다. 그러나 AI가 효율적으로 키워드를 추천하고, 상담사와 상담자를 효과적으로 매칭하기 위해 서비스를 시작할 때, 어떤 역할로 서비스를 시작할지 결정할 수 있습니다. 상담사로 시작하는 경우, 특정 분야의 지식과 경험이 필요할 수 있습니다. 이러한 정보를 묻고 그 결과를 바탕으로 자신에게 잘 맞는 상담자를 매칭 할 수 있습니다. 반면에 상담자로 시작하는 경우, 어떤 키워드로 상담을 받고 싶은지 키워드를 선택하도록 하여 바로 효율적인 상담이 가능하도록 도울 수 있습니다.**

</aside>

![상담사 선택.PNG](https://prod-files-secure.s3.us-west-2.amazonaws.com/31468e2d-8c82-4342-8c4d-2528c4d3e4b5/a4f3ba38-28e2-40e1-ba2d-4001d225020f/%EC%83%81%EB%8B%B4%EC%82%AC_%EC%84%A0%ED%83%9D.png)

![상담자 선택.PNG](https://prod-files-secure.s3.us-west-2.amazonaws.com/31468e2d-8c82-4342-8c4d-2528c4d3e4b5/897953e9-4127-4658-a90b-135f0dbdc59b/%EC%83%81%EB%8B%B4%EC%9E%90_%EC%84%A0%ED%83%9D.png)

<aside>
📚 **상담사 역할과 상담자 역할 중 선택하여 시작 할 수 있습니다.**

</aside>

# 😎빠른 메뉴 구성 창

---

![quick menu.PNG](https://prod-files-secure.s3.us-west-2.amazonaws.com/31468e2d-8c82-4342-8c4d-2528c4d3e4b5/6b892185-1f76-46c6-a23e-e259fbb011fd/quick_menu.png)

<aside>
🙏🏻 **상담자/상담사로 채팅 시작:  도움을 받고 싶을때는 상담자로 , 도움을 주고 싶을때는 상담사로 채팅을 시작해서,                                                            적절한 상담사나 상담자를 매칭 받게 됩니다.**

</aside>

<aside>
📚 **상담사/상담자 교육: 더욱 효과적인 상담을 위한 기본 교육을 제공하는 메뉴.**

</aside>

<aside>
❓ **질문하고 답하기: 게시판을 통해 궁금한 점을 물어보거나 답변을 할 수 있습니다.**

</aside>

# 😎게시판 커뮤니티

---

![게시판 커뮤니티.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/31468e2d-8c82-4342-8c4d-2528c4d3e4b5/9bdcc250-28f6-48d2-b186-128a2d2ff8ba/%EA%B2%8C%EC%8B%9C%ED%8C%90_%EC%BB%A4%EB%AE%A4%EB%8B%88%ED%8B%B0.png)

<aside>
🤝 **이용자들 간 자유롭게 소통하며 정보를 공유하고 만남을 형성 할 수 있는 커뮤니티 창입니다!**

</aside>

# 🧐데이터 분석을 위한 데이터 수집/처리

---

<aside>
👁️‍🗨️ **상담 중 오간 대화에서 중요 키워드를 탐색하고, 상담 받는 자의 감정을 분석하기 위해 DB분석 과정을 진행**

</aside>

## DB환경

> **먼저 MYSQL에 테이블들을 생성해서 싱글턴 대화와 멀티턴 대화를 상담자와 내담자를 구분지어 INSERT해주기 위해 jsonl파일을 불러오는 코드를             작성했다. 각각의 테이블들은 자동으로 데이터를 INSERT 했을 때 PRIMARY_KEY 역할을 하는 id가 주어집니다.**
> 

# Data insert

[insert_thread.py](https://prod-files-secure.s3.us-west-2.amazonaws.com/31468e2d-8c82-4342-8c4d-2528c4d3e4b5/65729d57-ee25-4070-b6cc-e78f0d238491/insert_thread.py)

- **멀티턴 데이터를 DB에 INSERT 해주기 위한 코드**
- **jsonl파일의 각각의 줄을 json으로 변환**
- **멀티턴 데이터들은 한 대화 쓰레드에 여러번의 대화가 오고가기 때문에 하나의 대화 쓰레드가 끝날 때 마다 leaf_node임을 알려주기 위하여 데이터 테이블에 is_leaf_node를 추가**
- **멀티턴 데이터는 client_comment와 counselor_comment 테이블 두개로 나누어 진행**
- **PRIMARY_KEY는 lient_comment에서는 client_key를 줄인 ck_1, ck_2 ... ck_x 로 주어지고 counselor_comment는 sk_1, sk_2 ... sk_x로 주어집니다.**
- **한 개의 대화 쓰레드에서 마지막 발언인 것을 확인하면 is_leaf_node에 1을 넣어주어 이 발언이 쓰레드의 마지막 발언임을 표시**

[insert_counselor.py](https://prod-files-secure.s3.us-west-2.amazonaws.com/31468e2d-8c82-4342-8c4d-2528c4d3e4b5/c9782450-c69b-4443-b9f9-c34af99bd643/insert_counselor.py)

- **멀티턴 데이터를 통해 ( 내담자의 대화 -> 상담사의 발언 -> 내담자의 반응 )을 통해 내담자의 감정이 어떻게 바뀌는지 보기 위해 데이터를 triplet 형식으로 삽입**
- **thread 테이블은 client_key_1, counselor_key, client_key_2 컬럼들로 구성되어 있으며, 이 데이터들은 모두 상담자의 인사로 시작이 되기 때문에 처음 상담자의 대화는 제외하고 thread 테이블에 INSERT**
- **각기 다른 테이블에서 값들을 불러와 INSERT 해주는 것이기 때문에 순서가 꼬이지 않게 예외처리**

[insert_disposable_counselor.py](https://prod-files-secure.s3.us-west-2.amazonaws.com/31468e2d-8c82-4342-8c4d-2528c4d3e4b5/1d5c1d72-863c-481a-914e-9851fa1742d2/insert_disposable_counselor.py)

- **싱글턴 장문 데이터를 DB에 INSERT 해주기 위한 코드**
- **jsonl파일의 각각의 줄을 json으로 변환**
- **싱글턴 장문 데이터는 client_disposable_comment와 counselor_disposable_comment 테이블 두개로 나누어 client_comment에는 내담자의 대화를, counselor_comment에는 상담자의 대화를 INSERT**
- **PRIMARY_KEY는 client_disposable_comment에서는 client_disposable_key를 줄인 cdk_1, cdk_2 ... cdk_x 로 주어지고 counselor_disposable_comment는 sdk_1, sdk_2 ... sdk_x로 주어집니다.**

# Pos_neg_nlp

[train_nlp.py](https://prod-files-secure.s3.us-west-2.amazonaws.com/31468e2d-8c82-4342-8c4d-2528c4d3e4b5/fc3b0742-27a2-437c-a028-92d20936525e/train_nlp.py)

- **cnn 분류기를 통해 긍정, 부정 라벨링이 되어있는 영화 리뷰 트레이닝 데이터를 학습**
- **그 가중치를 파일로 저장**

[insert_is_pos.py](https://prod-files-secure.s3.us-west-2.amazonaws.com/31468e2d-8c82-4342-8c4d-2528c4d3e4b5/9e0f8ee3-e4bc-4c8c-8b7a-d3166a4d1c99/insert_is_pos.py)

- **client_comment 테이블에 is_pos라는 컬럼을 추가**
- **client_comment 테이블을 통해 내담자의 상담 내용을 조회하여 그 내용이 긍정인지 부정인지 판단**
- **긍정이면 is_pos에 1을, 부정이면 0을 INSERT**

[predict_nlp.py](https://prod-files-secure.s3.us-west-2.amazonaws.com/31468e2d-8c82-4342-8c4d-2528c4d3e4b5/acbda266-3011-4245-b12e-531610444c67/predict_nlp.py)

- **학습한 분류기의 성능과 결과를 확인**
- **문장을 입력하면 긍정인지 부정인지에 대한 결과를 출력**

[preprocess_nlp.py](https://prod-files-secure.s3.us-west-2.amazonaws.com/31468e2d-8c82-4342-8c4d-2528c4d3e4b5/959b4e67-e6d9-4366-8bc9-ee662714ff3e/preprocess_nlp.py)

- **영화 리뷰 데이터를 학습시킬 수 있게 전처리**
- **한글과 공백을 제외한 문자를 모두 제거하고, okt 객체를 활용하여 문장을 형태소 단위로 나눠줍니다.**
- **리뷰가 문자열일 때만 전처리를 진행하도록 해줍니다.**
- **데이터의 라벨을 벡터화 해줘 데이터를 저장**

[test_nlp.py](https://prod-files-secure.s3.us-west-2.amazonaws.com/31468e2d-8c82-4342-8c4d-2528c4d3e4b5/e347b34b-f1ca-469e-8b48-52f7988c7bdb/test_nlp.py)

• **트레이닝 데이터를 통해 학습된 결과를 테스트 데이터에 테스트해서 정확도를 출력**

![위 파일들을 통한 문장 감정분석](https://prod-files-secure.s3.us-west-2.amazonaws.com/31468e2d-8c82-4342-8c4d-2528c4d3e4b5/d34c852d-38d2-4263-b31d-34b4ccbc6e1e/280765551-49541fe8-551c-4aa1-be76-642cd1e42f4d.png)

위 파일들을 통한 문장 감정분석

# Emotion Process

[emotion_test_nlp.py](https://prod-files-secure.s3.us-west-2.amazonaws.com/31468e2d-8c82-4342-8c4d-2528c4d3e4b5/fd8d51b4-0418-4edf-856b-9f82a97f797b/emotion_test_nlp.py)

• **트레이닝 데이터를 통해 학습된 결과를 테스트 데이터에 테스트해서 정확도를 출력**

[emotion_train_nlp.py](https://prod-files-secure.s3.us-west-2.amazonaws.com/31468e2d-8c82-4342-8c4d-2528c4d3e4b5/191fe366-5d1e-4f4e-88ae-2da840904862/emotion_train_nlp.py)

- **앞서 train_nlp.py와 같은 분류모델을 사용하지만 다중 클래스 분류 문제이므로 손실 함수를categorical_crossentropy로 설정**
- **이하 내용은 train_nlp.py와 같습니다.**

[emotion_preprocess_nlp.py](https://prod-files-secure.s3.us-west-2.amazonaws.com/31468e2d-8c82-4342-8c4d-2528c4d3e4b5/d5e2b6e6-467f-476a-b110-54e2f96593b9/emotion_preprocess_nlp.py)

• **6가지 감정이 라벨링 되어있는 AI hub에 공개되어 있는 상담 내용들을 preprocess_nlp.py와 같은 방식으로 전처리 해줍니다.**

[emotion_predict_nlp.py](https://prod-files-secure.s3.us-west-2.amazonaws.com/31468e2d-8c82-4342-8c4d-2528c4d3e4b5/c1777f51-889f-455b-9cbf-68dda8ccbf45/emotion_predict_nlp.py)

- **학습한 분류기의 성능과 결과를 확인**
- **문장을 입력하면 긍정인지 부정인지에 대한 결과를 출력**

[insert_emotion.py](https://prod-files-secure.s3.us-west-2.amazonaws.com/31468e2d-8c82-4342-8c4d-2528c4d3e4b5/c86906f0-3f5a-4969-8504-8d9fe2f2da0c/insert_emotion.py)

- **client_comment에 emotion이라는 컬럼을 추가**
- **client_comment 테이블을 통해 내담자의 상담 내용을 조회하여 [분노, 기쁨, 불안, 당황, 슬픔, 상처] 중 감정 하나를 상담 내용을 통해 판단**
- **판단 된 감정을 emotion 컬럼에 INSERT**

![위 파일들을 통한 문장 감정분석](https://prod-files-secure.s3.us-west-2.amazonaws.com/31468e2d-8c82-4342-8c4d-2528c4d3e4b5/76b17f27-ec84-44a3-b46d-d1c2c47eeab4/280769499-677c71de-158e-47fa-ab93-904f79afc2b9.png)

위 파일들을 통한 문장 감정분석

             

# Korean morphological analysis

[korean_morphological_analysis.py](https://prod-files-secure.s3.us-west-2.amazonaws.com/31468e2d-8c82-4342-8c4d-2528c4d3e4b5/1d7097e7-0118-4932-9652-1073fcfed93b/korean_morphological_analysis.py)

- **먼저 불용어 사전에 대한 데이터를 통해 문장에서 불용어를 제거해줍니다.**
- **불용어를 제거한 뒤 Okt를 통해 형태소 분석을 해줍니다.**
- **명사 위주로 된 형태소를 TF-IDF를 통해 문장에서 명사의 중요도를 판단합니다.**
- **가장 중요도가 높은 명사를 추출하여 출력해줍니다.**
- **내담자의 대화 내에서 중요한 단어를 찾아 상담자에게 보여주어 상담을 더 효과적으로 진행할 수 있게 해줍니다.**
    
    ![280932636-887375c7-6f2d-4831-b580-0e451811a803.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/31468e2d-8c82-4342-8c4d-2528c4d3e4b5/104efda3-2436-4160-96f8-8457ffc3c347/280932636-887375c7-6f2d-4831-b580-0e451811a803.png)
    

# 🧐적용 (초기)(추후 계속 수정)

---

![입장가능채팅방.PNG](https://prod-files-secure.s3.us-west-2.amazonaws.com/31468e2d-8c82-4342-8c4d-2528c4d3e4b5/d325cf57-93d5-49af-b5a2-5d830b0ee16a/%EC%9E%85%EC%9E%A5%EA%B0%80%EB%8A%A5%EC%B1%84%ED%8C%85%EB%B0%A9.png)

> **채팅하기를 시작하면, 현재 입장 할 수 있는 다양한 채팅방을 볼 수 있습니다.**
> 

> **상담사 또는 상담자를 기다리는 다양한 사람들이 채팅방을 만들고 기다리고 있습니다.**
> 

> **대화 방을 만들거나 입장하여 상담을 진행하여 보세요.**
> 

![채팅창2.PNG](https://prod-files-secure.s3.us-west-2.amazonaws.com/31468e2d-8c82-4342-8c4d-2528c4d3e4b5/76970062-d08e-483f-a75f-50a61d290ff1/%EC%B1%84%ED%8C%85%EC%B0%BD2.png)

> **한승철님이 입장하여 상담을 진행하고자 합니다.**
> 

> **“안녕하세요 너무 짜증나는데 도와주세요.” 와 같은 문장으로 대화를 시작합니다.**
> 

![감정분석.PNG](https://prod-files-secure.s3.us-west-2.amazonaws.com/31468e2d-8c82-4342-8c4d-2528c4d3e4b5/fdc7f7d4-d2af-47dd-a6f6-eee5b4cfbbbe/%EA%B0%90%EC%A0%95%EB%B6%84%EC%84%9D.png)

> **위 과정에서 json파일을 통해 분석한 데이터를 바탕으로            입력문장에서 감정을 읽고 핵심단어를 추출하여 출력해줍니다.**
> 

> **매번 입력문장에서 감정과 핵심단어를 추출해줍니다. 이것을 바탕으로 효율적인 상담을 진행하거나 받을 수 있습니다.**
> 

![KakaoTalk_20231108_232101957_01.jpg](https://prod-files-secure.s3.us-west-2.amazonaws.com/31468e2d-8c82-4342-8c4d-2528c4d3e4b5/a77b0592-b847-4221-b611-8b1c8a6a4f20/KakaoTalk_20231108_232101957_01.jpg)

> **모든 상담 내용은 데이터베이스에 안전하게 저장됩니다. 대화를 시작하기 전, 이전 상담 내용을 AI가 분석하여 감정과 핵심 단어를 추출하고 현재 상담자의 고민과 감정을 추측하여 대화를 시작할 수도 있습니다. 이를 통해 더 정확하고 맞춤형으로 상담을 진행할 수 있습니다. 또한, AI는 상담자의 이전 상담 내용을 확인하여 더 나은 해결책을 제시할 수 있습니다. 상담 내용은 안전하게 보호되며, 언제든지 필요할 때 참조할 수 있습니다.**
> 

<aside>
🤖 **남은 기간 동안 다양한 상담 데이터를 모아 학습을 시켜, 더 다양한 감정과 많은 핵심 단어를 추출 할 수 있도록 할 것이며, 추천 문장을 제시한다거나 상담의 방향을 제시하는 등 다양한 방면으로 기능을 확장시켜나갈 예정입니다. 또한 사용자들이 좀 더 보기 쉽고 기능을 쉽게 이해할 수 있도록 하는 디자인을 구성하여 새롭게 디자인을 적용시키려고 합니다. 이러한 기능들을 통해 전문가가 아니더라도 상담을 원활히 진행할 수 있도록 돕고, 누구나 상담받고 상담하는 INUBESTOUT 팀의 웹 서비스를 완성하고자 합니다. 또한, 사용자들에게 더욱 개인화된 상담 경험을 제공하기 위해 추가적인 기능도 개발할 예정입니다. 예를 들어, 사용자의 이전 상담 기록을 분석하여 특정한 감정이나 단어에 대해 더욱 정확한 조언을 해줄 수 있는 기능이 있을 것입니다. 또한, 사용자가 원하는 특정 주제에 대한 상담 문장을 추천해주는 기능도 도입할 계획입니다. 이러한 기능들을 통해 사용자들이 보다 풍부하고 유익한 상담 경험을 할 수 있도록 지원하고자 합니다.**

</aside>
